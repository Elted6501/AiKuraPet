<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Profile</title>
    <title>Street View split-map-panes</title>
    <link rel="stylesheet" href="css/profile.css" />
    <link rel="stylesheet" href="/css/nav.css" />
    <link rel="stylesheet" href="css/Footer.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
  </head>
  <body>
    <%- include("partials/nav")%>

    <section class="table-section">
      <h2 class="edit">Edit your data</h2>
      <svg
        class="edit-icon"
        xmlns="http://www.w3.org/2000/svg"
        width="32"
        height="32"
        viewBox="0 0 24 24"
      >
        <path
          fill="currentColor"
          d="m21.561 5.318l-2.879-2.879A1.495 1.495 0 0 0 17.621 2c-.385 0-.768.146-1.061.439L13 6H4a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-9l3.561-3.561c.293-.293.439-.677.439-1.061s-.146-.767-.439-1.06M11.5 14.672L9.328 12.5l6.293-6.293l2.172 2.172zm-2.561-1.339l1.756 1.728L9 15zM16 19H5V8h6l-3.18 3.18c-.293.293-.478.812-.629 1.289c-.16.5-.191 1.056-.191 1.47V17h3.061c.414 0 1.108-.1 1.571-.29c.464-.19.896-.347 1.188-.64L16 13zm2.5-11.328L16.328 5.5l1.293-1.293l2.171 2.172z"
        />
      </svg>
      <div class="table-container">
        <form id="edit-form" role="form">
          <div class="form-group">
            <input
              type="text"
              name="name"
              id="name"
              class="form-control input-lg"
              placeholder="User Name"
              tabindex="4"
              disabled
            />
          </div>
          <div class="form-group">
            <input
              type="number"
              name="age"
              id="age"
              class="form-control input-lg"
              placeholder="Age"
              tabindex="5"
              disabled/>
          </div>
          <div class="form-group">
            <input
              type="number"
              name="phonenumber"
              id="phonenumber"
              class="form-control input-lg"
              placeholder="Phone Number"
              tabindex="5"
              disabled
            />
          </div>
          <div class="row">
            <div class="col-sm-6">
              <div class="form-group">
                <input
                  type="password"
                  name="password"
                  id="password2"
                  class="form-control input-lg"
                  placeholder="Password"
                  tabindex="5"
                  disabled
                />
              </div>
            </div>
            <div class="col-sm-6">
              <div class="form-group">
                <input
                  type="password"
                  name="password"
                  id="password3"
                  class="form-control input-lg"
                  placeholder="Confirm Password"
                  tabindex="5"
                  disabled
                />
              </div>
            </div>
          </div>
          <div class="form-group">
            <button
              type="button"
              class="btn btn-primary btn-lg btn-block"
              id="save-btn"
            >
              Save
            </button>
          </div>
        </form>
      </div>
    </section>

    <%-include('partials/footer')%>
  </body>

  <!-- Funciones -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const editIcon = document.querySelector(".edit-icon");
      const formInputs = document.querySelectorAll("#edit-form input");
      const saveBtn = document.getElementById("save-btn");
      const phoneNumberInput = document.getElementById("phonenumber");
      let isEditable = false;
      const ageInput = document.getElementById("age");

      // Limitación en la edad
      ageInput.addEventListener("input", function () {
    let age = ageInput.value;
    // Remover la letra 'e' y cualquier otro carácter no numérico
    age = age.replace(/[^0-9]/g, '');
    // Limitar la longitud a 2 caracteres
    if (age.length > 2) {
      age = age.slice(0, 2);
    }
    ageInput.value = age;
  });

      // Acceso a los inputs
      const toggleFormInputs = () => {
        isEditable = !isEditable;
        formInputs.forEach((input) => {
          input.disabled = !isEditable;
        });
      };

      // Limpiar cajas y mandar a consola los datos
      const clearFormAndLogData = () => {
        formInputs.forEach((input) => {
          console.log(`${input.name}: ${input.value}`);
          input.value = "";
        });
      };

      // Deshabilitar cajitas
      formInputs.forEach((input) => {
        input.disabled = true;
      });

      // Click en edit
      editIcon.addEventListener("click", toggleFormInputs);

      saveBtn.addEventListener("click", function () {
        clearFormAndLogData();
        formInputs.forEach((input) => {
          input.disabled = true;
        });
        isEditable = false;
      });

      // 10 digitos necesarios en el número telefonico
      phoneNumberInput.addEventListener("input", function () {
    let phoneNumber = phoneNumberInput.value;
    // Remover la letra 'e' y cualquier otro carácter no numérico
    phoneNumber = phoneNumber.replace(/[^0-9]/g, '');
    // Limitar la longitud a 10 caracteres
    if (phoneNumber.length > 10) {
      alert("Can be only 10 digits");
      phoneNumber = phoneNumber.slice(0, 10); // Truncate to 10 digits
    }
    phoneNumberInput.value = phoneNumber;
  });

      saveBtn.addEventListener("click", function () {
        const phoneNumber = phoneNumberInput.value;
        if (phoneNumber.length !== 10) {
          alert("Enter 10 digits");
        } else {
          clearFormAndLogData();
          formInputs.forEach((input) => {
            input.disabled = true;
          });
          isEditable = false;
        }
      });
    });
  </script>
</html>
